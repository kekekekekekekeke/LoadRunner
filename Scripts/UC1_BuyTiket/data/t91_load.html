mw.loader.implement("ext.uls.displaysettings@hc6g1",function($,jQuery,require,module){(function(){'use strict';var template='<div class="uls-input-settings">'+'<div class="row">'+'<div class="twelve columns">'+'<h3 data-i18n="ext-uls-input-settings-title"></h3>'+'</div>'+'</div>'+'<div class="row enabled-only uls-input-settings-languages-title">'+'<div class="twelve columns">'+'<h4 data-i18n="ext-uls-input-settings-ui-language"></h4>'+'</div>'+'</div>'+'<div class="row enabled-only">'+'<div class="uls-ui-languages twelve columns"></div>'+'</div>'+'<div class="row enabled-only">'+'<div class="twelve columns">'+'<div class="uls-input-settings-inputmethods-list">'+'<h4 class="uls-input-settings-imes-title"></h4>'+'</div>'+'</div>'+'</div>'+'<div class="row">'+'<div class="twelve columns uls-input-settings-disable-info"></div>'+'<div class="ten columns uls-input-settings-toggle">'+'<button class="mw-ui-button mw-ui-progressive active uls-input-toggle-button"></button>'+'</div>'+'</div>';
function InputSettings($parent){this.nameI18n='ext-uls-input-settings-title-short';this.descriptionI18n='ext-uls-input-settings-desc';this.$template=$(template);this.uiLanguage=this.getInterfaceLanguage();this.contentLanguage=this.getContentLanguage();this.$parent=$parent;mw.ime.init();this.savedRegistry=$.extend(true,{},$.ime.preferences.registry);}InputSettings.prototype={constructor:InputSettings,render:function(){var $enabledOnly,webfonts=$(document.body).data('webfonts');this.dirty=false;this.$parent.$settingsPanel.empty();this.$parent.$settingsPanel.append(this.$template);$enabledOnly=this.$template.find('.enabled-only');if($.ime.preferences.isEnabled()){$enabledOnly.removeClass('hide');}else{$enabledOnly.addClass('hide');}this.prepareLanguages();this.prepareToggleButton();this.$parent.i18n();if(webfonts){webfonts.refresh();}this.listen();},markDirty:function(){this.dirty=true;this.$parent.enableApplyButton();},prepareInputmethods:function(language){var index,inputSettings,
$imeListContainer,defaultInputmethod,imes,selected,imeId,$imeListTitle;imes=$.ime.languages[language];$imeListTitle=this.$template.find('.uls-input-settings-imes-title');$imeListContainer=this.$template.find('.uls-input-settings-inputmethods-list');$imeListContainer.empty();if(!imes){$imeListContainer.append($('<label>').addClass('uls-input-settings-no-inputmethods').text($.i18n('ext-uls-input-settings-noime')));$imeListTitle.text('');return;}$imeListTitle.text($.i18n('ext-uls-input-settings-ime-settings',$.uls.data.getAutonym(language)));inputSettings=this;defaultInputmethod=$.ime.preferences.getIM(language)||imes.inputmethods[0];for(index in imes.inputmethods){imeId=imes.inputmethods[index];selected=defaultInputmethod===imeId;$imeListContainer.append(inputSettings.renderInputmethodOption(imeId,selected));}$imeListContainer.append(inputSettings.renderInputmethodOption('system',defaultInputmethod==='system'));this.$parent.position();},renderInputmethodOption:function(imeId,selected){
var $imeLabel,name,description,$helplink,inputmethod,$inputMethodItem;if(imeId!=='system'&&!$.ime.sources[imeId]){return $();}$imeLabel=$('<label>').attr('for',imeId);$inputMethodItem=$('<input>').attr({type:'radio',name:'ime',id:imeId,value:imeId}).prop('checked',selected);if(imeId==='system'){name=$.i18n('ext-uls-disable-input-method');description='';$helplink='';}else{inputmethod=$.ime.inputmethods[imeId];$helplink=$('<a>').addClass('uls-ime-help').text($.i18n('ext-uls-ime-help')).attr('href',mw.msg('uls-ime-helppage',imeId)).attr('target','_blank');if(!inputmethod){name=$.ime.sources[imeId].name;description='';}else{name=inputmethod.name;description=$.ime.inputmethods[imeId].description;}}$imeLabel.append($('<strong>').addClass('uls-input-settings-name').text(name+' '),$('<span>').addClass('uls-input-settings-description').text(description),$helplink);return $('<div>').addClass('mw-ui-radio').append($inputMethodItem,$imeLabel);},prepareLanguages:function(){var inputSettings=this,
SUGGESTED_LANGUAGES_NUMBER=3,selectedImeLanguage=$.ime.preferences.getLanguage(),languagesForButtons,$languages,suggestedLanguages,lang,i,language,$button,$caret;$languages=this.$template.find('.uls-ui-languages');suggestedLanguages=this.frequentLanguageList().concat(['en','zh','fr']);languagesForButtons=[this.contentLanguage];$languages.empty();if($.uls.data.languages[selectedImeLanguage]&&languagesForButtons.indexOf(selectedImeLanguage)===-1){languagesForButtons.push(selectedImeLanguage);}if(this.uiLanguage!==this.contentLanguage&&$.uls.data.languages[this.uiLanguage]&&languagesForButtons.indexOf(this.uiLanguage)===-1){languagesForButtons.push(this.uiLanguage);}for(lang in suggestedLanguages){if(languagesForButtons.indexOf(suggestedLanguages[lang])>-1){continue;}languagesForButtons.push(suggestedLanguages[lang]);if(languagesForButtons.length>=SUGGESTED_LANGUAGES_NUMBER){break;}}function buttonHandler(button){return function(){var selectedLang=button.data('language');if(selectedLang
!==$.ime.preferences.getLanguage()){inputSettings.markDirty();$.ime.preferences.setLanguage(selectedLang);}$('.uls-ui-languages .mw-ui-button').removeClass('mw-ui-pressed');button.addClass('mw-ui-pressed');inputSettings.prepareInputmethods(selectedLang);};}selectedImeLanguage=selectedImeLanguage||this.contentLanguage;for(i=0;i<SUGGESTED_LANGUAGES_NUMBER;i++){language=languagesForButtons[i];$button=$('<button>').addClass('mw-ui-button uls-language-button autonym').text($.uls.data.getAutonym(language)).prop({lang:language,dir:$.uls.data.getDir(language)});$button.data('language',language);$caret=$('<span>').addClass('uls-input-settings-caret');$languages.append($button,$caret);$button.on('click',buttonHandler($button));if(language===selectedImeLanguage){$button.trigger('click');}}this.prepareMoreLanguages();},prepareMoreLanguages:function(){var inputSettings=this,$languages,$moreLanguagesButton;$languages=this.$template.find('.uls-ui-languages');$moreLanguagesButton=$('<button>').prop(
'class','uls-more-languages').addClass('mw-ui-button').text('...');$languages.append($moreLanguagesButton);$moreLanguagesButton.uls({left:inputSettings.$parent.left,top:inputSettings.$parent.top,onReady:function(){var uls=this,$wrap,$back=$('<div>').addClass('uls-icon-back').data('i18n','ext-uls-back-to-input-settings').i18n().text(' ');$back.on('click',function(){uls.hide();inputSettings.$parent.show();});$wrap=$('<div>').addClass('uls-search-wrapper-wrapper');uls.$menu.find('.uls-search-wrapper').wrap($wrap);uls.$menu.find('.uls-search-wrapper-wrapper').prepend($back);uls.$menu.toggleClass('selector-left',inputSettings.$parent.$window.hasClass('selector-left'));uls.$menu.toggleClass('selector-right',inputSettings.$parent.$window.hasClass('selector-right'));},onVisible:function(){var $parent;this.$menu.find('.uls-languagefilter').prop('placeholder',$.i18n('ext-uls-input-settings-ui-language'));if(!inputSettings.$parent.$window.hasClass('callout')){return;}$parent=$(
'#language-settings-dialog');if(parseInt($parent.css('left'),10)){this.$menu.css('left',$parent.css('left'));}if(parseInt($parent.css('top'),10)){this.$menu.css('top',$parent.css('top'));}if(inputSettings.$parent.$window.hasClass('callout')){this.$menu.addClass('callout callout--languageselection');}else{this.$menu.removeClass('callout');}},onSelect:function(langCode){$.ime.preferences.setLanguage(langCode);inputSettings.$parent.show();inputSettings.prepareLanguages();inputSettings.markDirty();},languages:mw.ime.getLanguagesWithIME(),ulsPurpose:'input-settings'});$moreLanguagesButton.on('click',function(){inputSettings.$parent.hide();mw.hook('mw.uls.ime.morelanguages').fire();});},prepareToggleButton:function(){var $toggleButton,$toggleButtonDesc;$toggleButton=this.$template.find('.uls-input-toggle-button');$toggleButtonDesc=this.$template.find('.uls-input-settings-disable-info');if($.ime.preferences.isEnabled()){$toggleButton.data('i18n','ext-uls-input-disable');$toggleButtonDesc.hide
();}else{$toggleButton.data('i18n','ext-uls-input-enable');$toggleButtonDesc.data('i18n','ext-uls-input-disable-info').show();}$toggleButton.i18n();$toggleButtonDesc.i18n();},frequentLanguageList:function(){return mw.uls.getFrequentLanguageList();},getInterfaceLanguage:function(){return mw.config.get('wgUserLanguage');},getContentLanguage:function(){return mw.config.get('wgContentLanguage');},listen:function(){var inputSettings=this,$imeListContainer;$imeListContainer=this.$template.find('.uls-input-settings-inputmethods-list');$imeListContainer.on('change','input:radio[name=ime]:checked',function(){inputSettings.markDirty();$.ime.preferences.setIM($(this).val());});inputSettings.$template.find('button.uls-input-toggle-button').on('click',function(){inputSettings.markDirty();if($.ime.preferences.isEnabled()){inputSettings.disableInputTools();}else{inputSettings.enableInputTools();}});},disableInputTools:function(){$.ime.preferences.disable();mw.ime.disable();this.$template.find(
'.enabled-only').addClass('hide');this.prepareToggleButton();},enableInputTools:function(){$.ime.preferences.enable();mw.ime.setup();this.$template.find('.enabled-only').removeClass('hide');this.$template.scrollIntoView();this.prepareToggleButton();},close:function(){this.$parent.close();},onSave:function(success){if(success){this.$parent.hide();this.$parent.disableApplyButton();}},apply:function(){var previousIM,inputSettings=this,previousLanguage=inputSettings.savedRegistry.language,currentlyEnabled=$.ime.preferences.isEnabled(),currentLanguage=$.ime.preferences.getLanguage(),currentIM=$.ime.preferences.getIM(currentLanguage);if(!inputSettings.dirty){return;}inputSettings.$parent.setBusy(true);if(previousLanguage){previousIM=inputSettings.savedRegistry.imes[previousLanguage];}if(currentLanguage!==inputSettings.savedRegistry.language||currentIM!==previousIM){mw.hook('mw.uls.ime.change').fire(currentIM);}if(inputSettings.savedRegistry.enable!==currentlyEnabled){mw.hook(currentlyEnabled
?'mw.uls.ime.enable':'mw.uls.ime.disable').fire('inputsettings');}$.ime.preferences.save(function(result){inputSettings.onSave(result);inputSettings.dirty=false;inputSettings.savedRegistry=$.extend(true,{},$.ime.preferences.registry);inputSettings.$parent.setBusy(false);});},cancel:function(){if(!this.dirty){this.close();return;}$.ime.preferences.registry=$.extend(true,{},this.savedRegistry);this.uiLanguage=this.getInterfaceLanguage();this.contentLanguage=this.getContentLanguage();if($.ime.preferences.isEnabled()){mw.ime.setup();}else{mw.ime.disable();}this.close();}};$.fn.languagesettings.modules=$.extend($.fn.languagesettings.modules,{input:InputSettings});}());(function(){'use strict';var template='<div class="uls-display-settings">'+'<div class="row">'+'<div class="twelve columns uls-display-settings-tab-switcher">'+'<div class="uls-button-group mw-ui-button-group">'+'<button id="uls-display-settings-language-tab" class="mw-ui-button mw-ui-pressed" '+
'data-i18n="ext-uls-display-settings-language-tab"></button>'+'<button id="uls-display-settings-fonts-tab" class="mw-ui-button" data-i18n="ext-uls-display-settings-fonts-tab"></button>'+'</div>'+'</div>'+'</div>'+'<div class="uls-sub-panel uls-display-settings-language-tab">'+'<div class="row">'+'<div class="twelve columns">'+'<h4 data-i18n="ext-uls-display-settings-ui-language"></h4>'+'</div>'+'</div>'+'<div class="row">'+'<div class="uls-ui-languages twelve columns">'+'<p data-i18n="ext-uls-language-buttons-help"></p>'+'</div>'+'</div>'+'</div>'+'<div class="uls-sub-panel uls-display-settings-fonts-tab hide">'+'<div class="row">'+'<div class="twelve columns">'+'<h4 data-i18n="ext-uls-display-settings-font-settings"></h4>'+'</div>'+'</div>'+'<div id="uls-display-settings-font-selectors" class="uls-display-settings-font-selectors">'+'<div class="row uls-font-item uls-content-fonts">'+'<div class="six columns">'+'<label class="uls-font-label" id="content-font-selector-label"></label>'+
'</div>'+'<select id="content-font-selector" class="four columns end uls-font-select"></select>'+'</div>'+'<div class="row uls-font-item uls-ui-fonts">'+'<div class="six columns">'+'<label class="uls-font-label" id="ui-font-selector-label"></label>'+'</div>'+'<select id="ui-font-selector" class="four columns end uls-font-select"></select>'+'</div>'+'</div>'+'<div class="row">'+'<div class="twelve columns">'+'<div class="mw-ui-checkbox">'+'<input type="checkbox" id="webfonts-enable-checkbox" />'+'<label class="checkbox" for="webfonts-enable-checkbox" >'+'<strong data-i18n="ext-uls-webfonts-settings-title"></strong> '+'<span data-i18n="ext-uls-webfonts-settings-info"></span> '+'<a target="_blank" href="https://www.mediawiki.org/wiki/Universal_Language_Selector/WebFonts" data-i18n="ext-uls-webfonts-settings-info-link"></a>'+'</label>'+'</div>'+'</div>'+'</div>'+'</div>';function DisplaySettings($parent){this.nameI18n='ext-uls-display-settings-title-short';this.descriptionI18n=
'ext-uls-display-settings-desc';this.$template=$(template);this.uiLanguage=this.getUILanguage();this.contentLanguage=this.getContentLanguage();this.$webfonts=null;this.$parent=$parent;this.savedRegistry=$.extend(true,{},mw.webfonts.preferences);this.dirty=false;}DisplaySettings.prototype={constructor:DisplaySettings,setupWebFonts:function(){var d=$.Deferred();mw.loader.using(['ext.uls.webfonts.repository']).then(function(){if(this.isWebFontsEnabled){mw.webfonts.setup();}setTimeout(function(){this.$webfonts=$(document.body).data('webfonts');d.resolve();}.bind(this),1);}.bind(this));return d.promise();},render:function(){this.setupWebFonts().then(function(){this.renderAfterDependenciesLoaded();}.bind(this));},renderAfterDependenciesLoaded:function(){this.$parent.$settingsPanel.empty();this.$parent.$settingsPanel.append(this.$template);this.prepareLanguages();this.prepareUIFonts();this.prepareContentFonts();this.prepareWebfontsCheckbox();this.preview(this.uiLanguage);this.listen();},
prepareWebfontsCheckbox:function(){var webFontsEnabled=this.isWebFontsEnabled();if(!webFontsEnabled){$('#uls-display-settings-font-selectors').addClass('hide');}$('#webfonts-enable-checkbox').prop('checked',webFontsEnabled);},isWebFontsEnabled:function(){return mw.webfonts.preferences.isEnabled();},prepareLanguages:function(){var $loginCta,displaySettings=this,SUGGESTED_LANGUAGES_NUMBER=3,anonsAllowed=mw.config.get('wgULSAnonCanChangeLanguage'),languagesForButtons,$languages,suggestedLanguages,lang,i,language,$button,autonym;if(!anonsAllowed&&mw.user.isAnon()){$loginCta=$('<p>').attr('id','uls-display-settings-anon-log-in-cta');autonym=$.uls.data.getAutonym(this.contentLanguage);this.$template.find('.uls-display-settings-language-tab').empty().append($('<p>').append($('<span>').addClass('uls-display-settings-anon-label').html($.i18n('ext-uls-display-settings-anon-label')+'&#160;'),$('<span>').text($.i18n('ext-uls-display-settings-anon-same-as-content',autonym))),$loginCta);new mw.Api()
.parse($.i18n('ext-uls-display-settings-anon-log-in-cta')).done(function(parsedCta){$loginCta.html(parsedCta);$loginCta.find('a').on('click',function(){mw.hook('mw.uls.login.click');});});return;}$languages=this.$template.find('div.uls-ui-languages');suggestedLanguages=this.frequentLanguageList().concat(['en','zh','fr']);languagesForButtons=[this.contentLanguage];$languages.find('button').remove();if(this.uiLanguage!==this.contentLanguage){languagesForButtons.push(this.uiLanguage);}for(lang in suggestedLanguages){if(languagesForButtons.indexOf(suggestedLanguages[lang])>-1){continue;}languagesForButtons.push(suggestedLanguages[lang]);if(languagesForButtons.length>=SUGGESTED_LANGUAGES_NUMBER){break;}}function buttonHandler(button){return function(){displaySettings.markDirty();displaySettings.uiLanguage=button.data('language')||displaySettings.uiLanguage;$('div.uls-ui-languages button.mw-ui-button').removeClass('mw-ui-pressed');button.addClass('mw-ui-pressed');displaySettings.
prepareUIFonts();displaySettings.preview(displaySettings.uiLanguage);};}for(i=0;i<SUGGESTED_LANGUAGES_NUMBER;i++){language=languagesForButtons[i];$button=$('<button>').addClass('mw-ui-button uls-language-button autonym').text($.uls.data.getAutonym(language)).prop({lang:language,dir:$.uls.data.getDir(language)});if(language===this.uiLanguage){$button.addClass('mw-ui-pressed');}$button.data('language',language);$languages.append($button);$button.on('click',buttonHandler($button));}this.prepareMoreLanguages();},prepareMoreLanguages:function(){var $languages,$moreLanguagesButton,displaySettings=this;$languages=this.$template.find('div.uls-ui-languages');$moreLanguagesButton=$('<button>').prop('class','uls-more-languages').addClass('mw-ui-button').text('...');$languages.append($moreLanguagesButton);$moreLanguagesButton.uls({onPosition:this.$parent.position.bind(this.$parent),onReady:function(){var $wrap,uls=this,$back=$('<div>').addClass('uls-icon-back');$back.on('click',function(){uls.hide
();displaySettings.$parent.show();});$wrap=$('<div>').addClass('uls-search-wrapper-wrapper');uls.$menu.find('.uls-search-wrapper').wrap($wrap);uls.$menu.find('.uls-search-wrapper-wrapper').prepend($back);uls.$menu.toggleClass('selector-left',displaySettings.$parent.$window.hasClass('selector-left'));uls.$menu.toggleClass('selector-right',displaySettings.$parent.$window.hasClass('selector-right'));},onVisible:function(){this.$menu.find('.uls-languagefilter').prop('placeholder',$.i18n('ext-uls-display-settings-ui-language'));if(!displaySettings.$parent.$window.hasClass('callout')){return;}if(displaySettings.$parent.$window.hasClass('callout')){this.$menu.addClass('callout callout--languageselection');}else{this.$menu.removeClass('callout');}},onSelect:function(langCode){displaySettings.uiLanguage=langCode;displaySettings.$template.attr('lang',langCode);displaySettings.$parent.show();displaySettings.markDirty();},ulsPurpose:'interface-language',quickList:function(){return mw.uls.
getFrequentLanguageList();}});$moreLanguagesButton.on('click',function(){displaySettings.$parent.hide();mw.hook('mw.uls.interface.morelanguages').fire();});},preview:function(language){var displaySettings=this;this.$template.attr('lang',language).css('font-family','');$.i18n().locale=language;mw.uls.loadLocalization(language).done(function(){displaySettings.i18n();if(displaySettings.$webfonts){displaySettings.$webfonts.refresh();}});},frequentLanguageList:function(){return mw.uls.getFrequentLanguageList();},getUILanguage:function(){return mw.config.get('wgUserLanguage');},getContentLanguage:function(){return mw.config.get('wgContentLanguage');},prepareFontSelector:function(target){var language,fonts,$fontSelector,savedFont,$systemFont,$fontLabel,$fontsSection;language=this[target+'Language'];if(this.isWebFontsEnabled()){fonts=this.$webfonts.list(language);}else{fonts=[];}$fontsSection=this.$template.find('div.uls-'+target+'-fonts');if(fonts.length===0){$fontsSection.hide();return;}
$fontsSection.show();$fontSelector=this.$template.find('#'+target+'-font-selector');$fontSelector.find('option').remove();savedFont=this.$webfonts.getFont(language);fonts.forEach(function(font){var $fontOption;if(font!=='system'){$fontOption=$('<option>').attr('value',font).text(font);$fontSelector.append($fontOption);$fontOption.prop('selected',savedFont===font);}});$fontSelector.prop('disabled',!this.isWebFontsEnabled());$systemFont=$('<option>').val('system').attr('data-i18n','ext-uls-webfonts-system-font');$fontSelector.append($systemFont);$systemFont.prop('selected',savedFont==='system'||!savedFont);$fontLabel=this.$template.find('#'+target+'-font-selector-label');$fontLabel.empty();$fontLabel.append($('<strong>'));$fontLabel.append($('<div>').attr('data-i18n','ext-uls-webfonts-select-for-'+target+'-info'));},i18n:function(){this.$parent.i18n();this.$template.find('#ui-font-selector-label strong').text($.i18n('ext-uls-webfonts-select-for',$.uls.data.getAutonym(this.uiLanguage)));
this.$template.find('#content-font-selector-label strong').text($.i18n('ext-uls-webfonts-select-for',$.uls.data.getAutonym(this.contentLanguage)));},prepareUIFonts:function(){if(this.uiLanguage===this.contentLanguage){this.$template.find('div.uls-ui-fonts').hide();return;}this.prepareFontSelector('ui');},prepareContentFonts:function(){this.prepareFontSelector('content');},markDirty:function(){this.dirty=true;this.$parent.enableApplyButton();},listen:function(){var displaySettings=this,$contentFontSelector=this.$template.find('#content-font-selector'),$uiFontSelector=this.$template.find('#ui-font-selector'),$tabButtons=displaySettings.$template.find('.uls-display-settings-tab-switcher button');$('#webfonts-enable-checkbox').on('click',function(){var $fontSelectors=$('#uls-display-settings-font-selectors');displaySettings.markDirty();if(this.checked){displaySettings.setupWebFonts().then(function(){mw.webfonts.preferences.enable();displaySettings.prepareContentFonts();displaySettings.
prepareUIFonts();displaySettings.i18n();displaySettings.$webfonts.apply($uiFontSelector.find('option:selected'));displaySettings.$webfonts.refresh();$fontSelectors.removeClass('hide');});}else{$fontSelectors.addClass('hide');mw.webfonts.preferences.disable();mw.webfonts.preferences.setFont(displaySettings.uiLanguage,'system');displaySettings.$webfonts.refresh();$contentFontSelector.prop('disabled',true);$uiFontSelector.prop('disabled',true);}});$uiFontSelector.on('change',function(){displaySettings.markDirty();mw.webfonts.preferences.setFont(displaySettings.uiLanguage,$(this).val());displaySettings.$webfonts.refresh();});$contentFontSelector.on('change',function(){displaySettings.markDirty();mw.webfonts.preferences.setFont(displaySettings.contentLanguage,$(this).val());displaySettings.$webfonts.refresh();});$tabButtons.on('click',function(){var $button=$(this);if($button.hasClass('mw-ui-pressed')){return;}displaySettings.$template.find('.uls-sub-panel').each(function(){var $subPanel=$(
this);if($subPanel.hasClass($button.attr('id'))){$subPanel.removeClass('hide');}else{$subPanel.addClass('hide');}});displaySettings.$parent.position();$tabButtons.removeClass('mw-ui-pressed');$button.addClass('mw-ui-pressed');}).on('mousedown',function(event){event.preventDefault();});},close:function(){this.$parent.close();},onSave:function(success){if(success){if(this.$webfonts){this.$webfonts.refresh();}this.$parent.hide();if(this.uiLanguage!==this.getUILanguage()){mw.uls.changeLanguage(this.uiLanguage);}this.$parent.disableApplyButton();}},apply:function(){if(!this.dirty){return;}this.$parent.setBusy(true);mw.webfonts.preferences.save(function(result){var newWebfontsEnable,oldWebfontsEnable,webfontsEvent,newRegistry=mw.webfonts.preferences.registry,oldRegistry=this.savedRegistry.registry,newFonts=newRegistry.fonts||{},oldFonts=oldRegistry.fonts||{};newWebfontsEnable=newRegistry.webfontsEnabled;oldWebfontsEnable=oldRegistry.webfontsEnabled;if(oldWebfontsEnable===undefined){
oldWebfontsEnable=mw.config.get('wgULSWebfontsEnabled');}if(newWebfontsEnable!==oldWebfontsEnable){webfontsEvent=newWebfontsEnable?'mw.uls.webfonts.enable':'mw.uls.webfonts.disable';mw.hook(webfontsEvent).fire('displaysettings');}if(newFonts[this.uiLanguage]!==oldFonts[this.uiLanguage]){mw.hook('mw.uls.font.change').fire('interface',this.uiLanguage,newFonts[this.uiLanguage]);}if(newFonts[this.contentLanguage]!==oldFonts[this.contentLanguage]){mw.hook('mw.uls.font.change').fire('content',this.contentLanguage,newFonts[this.contentLanguage]);}this.onSave(result);this.dirty=false;this.savedRegistry=$.extend(true,{},mw.webfonts.preferences);this.$parent.setBusy(false);}.bind(this));},cancel:function(){if(!this.dirty){this.close();return;}mw.webfonts.preferences=$.extend(true,{},this.savedRegistry);if(this.$webfonts){this.$webfonts.refresh();}this.uiLanguage=this.getUILanguage();this.contentLanguage=this.getContentLanguage();this.close();}};$.fn.languagesettings.modules=$.extend($.fn.
languagesettings.modules,{display:DisplaySettings});}());},{"css":[
".imelabel{display:block;padding-bottom:10px;font-size:10pt;line-height:16pt}.imelabel span{padding-left:5px}.imelabel input{float:left}.uls-ime-menu-settings-item{background-color:#f8f9fa;color:#202122;border-top:1px solid #c8ccd1;border-radius:0 0 2px 2px;margin-top:6px;padding:4px 2px;position:relative}.uls-ime-disable-link{background:transparent url(/w/extensions/UniversalLanguageSelector/resources/images/remove-input.svg?d75b4) no-repeat left top;background-size:auto 16px;padding-left:22px;padding-right:26px;padding-bottom:10px;cursor:pointer}.uls-ime-more-settings-link{background:transparent url(/w/extensions/UniversalLanguageSelector/resources/images/cog.svg?d6cee) no-repeat center top;background-size:auto 14px;border-left:1px solid #c8ccd1;width:22px;height:14px;position:absolute;right:0;cursor:pointer}.uls-ime-menu-settings-item \u003E a:hover{background-color:#f8f9fa;color:#000}.uls-input-settings-imes-title:empty{display:none}.uls-input-settings-disable-info,.uls-input-settings-no-inputmethods{color:#54595d;padding-top:10px;padding-bottom:15px;font-size:11pt}.down + .uls-input-settings-caret{display:inline-block;width:0;height:0;border-top:0;border-right:8px solid transparent;border-left:8px solid transparent;border-bottom:8px solid #f8f9fa;content:'';position:relative;vertical-align:bottom;top:12px;left:-16%;margin:0 -8px}.uls-input-settings-toggle{padding-top:10px;margin-bottom:10px}.uls-input-settings .uls-input-settings-inputmethods-list{margin:12px 0;padding:6px 10px;background:#f8f9fa}.uls-input-settings .uls-input-settings-inputmethods-list .uls-input-settings-name{unicode-bidi:-moz-isolate;unicode-bidi:isolate}.uls-input-settings-inputmethods-list .mw-ui-radio{display:block}.uls-ime-notification-bubble .link{color:#36c;cursor:pointer}.uls-input-settings .uls-ime-help{margin-left:10px} .ime-perime-help{display:none}.ime-checked .ime-perime-help{display:inline-block;width:20px;height:100%;position:absolute;top:0;bottom:0;right:4px;opacity:0.81;padding:0;background:transparent url(/w/extensions/UniversalLanguageSelector/resources/images/help.svg?fa351) no-repeat right center;background-size:16px 16px}.ime-checked .ime-perime-help:hover{opacity:1}   .uls-display-settings-tab-switcher{text-align:center}.uls-button-group{display:inline-block;position:relative;padding:0 0 0 0;left:-20px;z-index:1}.uls-sub-panel{border-top:1px solid #eaecf0;padding-top:25px;top:-20px;position:relative;min-height:150px}.uls-display-settings-font-selectors{margin:5px 0 15px 0}.uls-font-item{border-bottom:1px solid #eaecf0;background:#f8f9fa;padding:10px 0}.uls-font-item:first-child{border-top:1px solid #eaecf0} .uls-font-label,.uls-font-select,#uls-display-settings-anon-log-in-cta{font-size:10pt} .uls-font-label{color:#54595d;font-size:10pt}.uls-font-label strong{color:#202122}.uls-display-settings-anon-label{font-weight:bold}"
]});mw.loader.implement("ext.uls.languagesettings@iri8q",function($,jQuery,require,module){(function(){'use strict';var closeRow,settingsMenu,settingsPanel,windowTemplate,panelsRow,buttonsRow;closeRow='<div class="row">'+'<div class="uls-language-settings-close-block eight columns offset-by-four"><span id="languagesettings-close" class="uls-icon-close"></span></div>'+'</div>';settingsMenu='<div class="four columns languagesettings-menu">'+'<h1 data-i18n="ext-uls-language-settings-title"></h1>'+'<div class="settings-menu-items">'+'</div>'+'</div>';settingsPanel='<div id="languagesettings-settings-panel" class="eight columns">'+'</div>';buttonsRow='<div class="row collapse language-settings-buttons">'+'<div class="twelve columns">'+'<button class="mw-ui-button uls-settings-cancel" data-i18n="ext-uls-language-settings-cancel"></button>'+'<button class="mw-ui-button mw-ui-progressive active uls-settings-apply" data-i18n="ext-uls-language-settings-apply" disabled></button>'+'</div>'+'</div>'+
'</div>';panelsRow='<div class="row" id="languagesettings-panels">'+settingsMenu+settingsPanel+'</div>';windowTemplate='<div style="display: block;" id="language-settings-dialog" class="language-settings-dialog grid uls-menu uls-wide">'+closeRow+panelsRow+buttonsRow+'</div>';function LanguageSettings(element,options){this.$element=$(element);this.options=$.extend({},$.fn.languagesettings.defaults,options);this.$window=$(this.options.template);this.shown=false;this.initialized=false;this.left=this.options.left;this.top=this.options.top;this.modules={};this.$settingsPanel=this.$window.find('#languagesettings-settings-panel');this.$applyButton=this.$window.find('.uls-settings-apply');this.init();this.listen();if(options.autoOpen){this.show();}}LanguageSettings.prototype={constructor:LanguageSettings,init:function(){$(document.body).append(this.$window);this.hide();},listen:function(){this.$element.on('click',this.click.bind(this));this.$window.find(
'#languagesettings-close, button.uls-settings-cancel').on('click',mw.hook('mw.uls.settings.cancel').fire.bind(this));this.$applyButton.on('click',mw.hook('mw.uls.settings.apply').fire.bind(this));$(document.documentElement).on('click',this.hide.bind(this));this.$window.on('click',function(event){event.stopPropagation();});this.$window.on('keyup',function(event){if(event.which===27){event.stopPropagation();mw.hook('mw.uls.settings.cancel').fire();}});},render:function(){var modules,languageSettings=this,defaultModule=this.options.defaultModule;modules=Object.keys($.fn.languagesettings.modules).sort();modules.forEach(function(moduleName){if(!defaultModule){defaultModule=moduleName;}languageSettings.initModule(moduleName,defaultModule===moduleName);});},initModule:function(moduleName,active){var $settingsTitle,$settingsText,$settingsLink,languageSettings=this,module=new $.fn.languagesettings.modules[moduleName](languageSettings),$settingsMenuItems=languageSettings.$window.find(
'.settings-menu-items');$settingsTitle=$('<div>').addClass('settings-title').attr('data-i18n',module.nameI18n);$settingsText=$('<span>').addClass('settings-text').attr('data-i18n',module.descriptionI18n);$settingsLink=$('<button>').addClass(moduleName+'-settings-block menu-section').prop('id',moduleName+'-panel-trigger').data('module',module).append($settingsTitle,$settingsText);if(active){$settingsLink.addClass('active');}$settingsMenuItems.append($settingsLink);$settingsLink.on('click',function(){var $this=$(this);$this.data('module').render();if(languageSettings.$window.is(':visible')){languageSettings.$window.scrollIntoView();}$settingsMenuItems.find('.menu-section').removeClass('active');$this.addClass('active');});this.modules[moduleName]=module;mw.hook('mw.uls.settings.cancel').add(module.cancel.bind(module));mw.hook('mw.uls.settings.apply').add(module.apply.bind(module));},position:function(){if(this.options.onPosition){return this.options.onPosition.call(this);}this.top=this.
top||this.$element.offset().top+this.$element.outerHeight();this.left=this.left||'25%';return{top:this.top,left:this.left};},i18n:function(){this.$window.i18n();},show:function(){this.$window.css(this.position());if(!this.initialized){this.render();this.initialized=true;}$(document.documentElement).trigger('click');this.i18n();this.$window.find('.settings-menu-items > .active').trigger('click');this.shown=true;this.$window.show();this.visible();this.$window.scrollIntoView();this.$window.find('.menu-section.active').trigger('focus');},visible:function(){if(this.options.onVisible){this.options.onVisible.call(this);}},hide:function(){this.shown=false;this.$window.hide();},setBusy:function(busy){if(busy){this.$window.addClass('waiting');this.$applyButton.text($.i18n('ext-uls-language-settings-applying')).prop('disabled',true);}else{this.$window.removeClass('waiting');this.$applyButton.text($.i18n('ext-uls-language-settings-apply'));}},close:function(){if(!this.shown){return;}this.hide();if
(this.options.onClose){this.options.onClose();}},click:function(e){e.stopPropagation();e.preventDefault();if(this.shown){this.hide();}else{this.show();}},enableApplyButton:function(){this.$applyButton.prop('disabled',false);},disableApplyButton:function(){this.$applyButton.prop('disabled',true);}};$.fn.languagesettings=function(option){return this.each(function(){var $this=$(this),data=$this.data('languagesettings'),options=typeof option==='object'&&option;if(!data){$this.data('languagesettings',(data=new LanguageSettings(this,options)));}if(typeof option==='string'){data[option]();}});};$.fn.languagesettings.modules={};$.fn.languagesettings.defaults={template:windowTemplate,defaultModule:false,onClose:null,top:null,left:null,onVisible:null,onPosition:null,autoOpen:false};$.fn.languagesettings.Constructor=LanguageSettings;}());},{"css":[
".uls-menu h3{border-bottom:medium none;font-size:14pt;line-height:1.5em;margin-bottom:10px;margin-top:0;padding-left:0}.languagesettings-menu{ }.grid .languagesettings-menu{padding-left:0;padding-right:0}.languagesettings-menu h1{color:#000;font-size:16pt;line-height:20pt;margin-top:0;font-weight:normal;border:0;padding:8px 0 3px 15px}.languagesettings-menu .menu-section{ text-align:left;width:100%; outline:0;color:#202122;padding:5px 0 5px 42px;border:1px solid transparent;background:left 15px top 6px transparent no-repeat;background-size:20px auto;cursor:pointer; }.languagesettings-menu .menu-section::-moz-focus-inner{border:0}.languagesettings-menu .menu-section.active{color:#000;background-color:#fff;padding-left:40px;background-position:left 13px top 6px;border-left-width:3px;border-left-color:#36c}.languagesettings-menu .menu-section:hover{background-color:#fff}.languagesettings-menu .menu-section:focus{border-color:#36c}.languagesettings-menu .menu-section .settings-title{font-size:13pt}.languagesettings-menu .menu-section .settings-text{color:#54595d;font-size:9pt}.languagesettings-menu .menu-section:hover .settings-text{color:#202122}.languagesettings-menu .menu-section.display-settings-block{background-image:url(/w/extensions/UniversalLanguageSelector/resources/images/display.svg?b78f7)}.languagesettings-menu .menu-section.input-settings-block{background-image:url(/w/extensions/UniversalLanguageSelector/resources/images/input.svg?e7c85)}#languagesettings-settings-panel{padding:0 15px;color:#202122;background:#fff}#languagesettings-settings-panel h3{color:#202122;padding-top:15px;margin-top:1pt;line-height:20pt;font-size:16pt}#languagesettings-settings-panel h4{color:#202122;font-size:12pt}.language-settings-dialog{background:#f8f9fa; font-size:medium}.uls-language-settings-close-block{background:#fff}.language-settings-buttons{border-top:1px solid #eaecf0;margin-top:25px;padding:15px;width:auto;text-align:right}.language-settings-buttons button{margin-left:15px}.uls-ui-languages p,.checkbox{color:#54595d;font-size:10pt} #languagesettings-panels .mw-ui-pressed{background-color:#2a4b8d;color:#fff;border-color:#2a4b8d}.checkbox input[type='checkbox']{margin-left:0}.checkbox strong{color:#202122}label.checkbox input[type='checkbox']{float:left}.waiting{cursor:progress}.uls-icon-close{background:transparent url(/w/extensions/UniversalLanguageSelector/resources/images/close.svg?e27a0) no-repeat center center;background-size:16px 16px;float:right;padding:16px;cursor:pointer}"
]});mw.loader.implement("mediawiki.ui.radio@1wdq6",null,{"css":[
".mw-ui-radio{display:inline-block;vertical-align:middle}.client-js .mw-ui-radio{position:relative;line-height:1.5625em}.client-js .mw-ui-radio *{font-size:inherit;vertical-align:middle}.client-js .mw-ui-radio [type='radio']{width:1.5625em;height:1.5625em;max-width:none;opacity:0}.client-js .mw-ui-radio [type='radio'] + label{padding-left:0.4em}.client-js .mw-ui-radio [type='radio'] + label:before{content:'';background-color:#fff;box-sizing:border-box;position:absolute;left:0;width:1.5625em;height:1.5625em;border:1px solid #72777d;border-radius:100%}.client-js .mw-ui-radio [type='radio'] + label:after{content:' ';position:absolute;top:2px;left:2px;width:1.14285em;height:1.14285em;border:1px solid transparent;border-radius:100%}.client-js .mw-ui-radio [type='radio']:checked + label:before{border-width:6px}.client-js .mw-ui-radio [type='radio']:enabled{cursor:pointer}.client-js .mw-ui-radio [type='radio']:enabled + label:before{cursor:pointer;transition:background-color 100ms,color 100ms,border-color 100ms}.client-js .mw-ui-radio [type='radio']:enabled:hover + label:before{border-color:#3366cc}.client-js .mw-ui-radio [type='radio']:enabled:active + label:before{background-color:#2a4b8d;border-color:#2a4b8d}.client-js .mw-ui-radio [type='radio']:enabled:checked + label:before{border-color:#3366cc}.client-js .mw-ui-radio [type='radio']:enabled:checked:focus + label:after{border-color:#fff}.client-js .mw-ui-radio [type='radio']:enabled:checked:hover + label:before{border-color:#447ff5}.client-js .mw-ui-radio [type='radio']:enabled:checked:active + label:before{border-color:#2a4b8d;box-shadow:inset 0 0 0 1px #2a4b8d}.client-js .mw-ui-radio [type='radio']:enabled:checked:active + label:after{border-color:#2a4b8d}.client-js .mw-ui-radio [type='radio']:disabled + label:before{background-color:#c8ccd1;border-color:#c8ccd1}.client-js .mw-ui-radio [type='radio']:disabled:checked + label:before{background-color:#fff}"
]});